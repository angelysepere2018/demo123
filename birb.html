<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Kiwi the Parrot ‚Äì Seed Game</title>
  <style>
    body { text-align: center; background: #e0f7fa; font-family: Arial, sans-serif; }
    canvas { background: #fff; display: block; margin: 10px auto; border: 3px solid #4caf50; }
    #ui { margin-top: 10px; }
    button { padding: 10px 20px; margin: 5px; font-size: 16px; border-radius: 12px; border: none; background: #4caf50; color: #fff; cursor: pointer; }
    button:hover { background: #43a047; }
  </style>
</head>
<body>
  <h1>Kiwi ü•ù</h1>
  <p>Help Kiwi eat seeds (üå∞) and stars (‚≠ê) while avoiding peppers (üå∂Ô∏è).<br>
     Move with arrow keys or WASD. Get points before time runs out!</p>
  <canvas id="gameCanvas" width="400" height="400"></canvas>
  <div id="ui">
    <button onclick="startGame()">Start</button>
    <button onclick="resetGame()">Reset</button>
    <p id="status"></p>
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    let kiwi = { x: 200, y: 200, size: 20, color: 'green' };
    let seeds = [];
    let stars = [];
    let peppers = [];
    let score = 0;
    let lives = 3;
    let timeLeft = 60;
    let gameInterval;
    let gameRunning = false;
    let keys = {};

    let speech = null; // bubble text
    let speechTimer = 0;

    document.addEventListener('keydown', (e) => keys[e.key] = true);
    document.addEventListener('keyup', (e) => keys[e.key] = false);

    function startGame() {
      resetGame();
      gameRunning = true;
      gameInterval = setInterval(updateGame, 1000/30);
      setInterval(() => { if(gameRunning) timeLeft--; }, 1000);
    }

    function resetGame() {
      clearInterval(gameInterval);
      kiwi.x = 200; kiwi.y = 200;
      score = 0; lives = 3; timeLeft = 60;
      seeds = []; stars = []; peppers = [];
      gameRunning = false;
      speech = null;
      drawGame();
    }

    function randomPos() {
      return Math.floor(Math.random() * 380) + 10;
    }

    function spawnItems() {
      if (Math.random() < 0.05) seeds.push({x: randomPos(), y: randomPos()});
      if (Math.random() < 0.02) stars.push({x: randomPos(), y: randomPos()});
      if (Math.random() < 0.02) peppers.push({x: randomPos(), y: randomPos()});
    }

    function updateGame() {
      // movement
      if (keys['ArrowUp'] || keys['w']) kiwi.y -= 3;
      if (keys['ArrowDown'] || keys['s']) kiwi.y += 3;
      if (keys['ArrowLeft'] || keys['a']) kiwi.x -= 3;
      if (keys['ArrowRight'] || keys['d']) kiwi.x += 3;

      // boundaries
      kiwi.x = Math.max(0, Math.min(canvas.width - kiwi.size, kiwi.x));
      kiwi.y = Math.max(0, Math.min(canvas.height - kiwi.size, kiwi.y));

      // collisions
      seeds.forEach((s, i) => {
        if (Math.abs(kiwi.x - s.x) < 15 && Math.abs(kiwi.y - s.y) < 15) {
          seeds.splice(i,1);
          score += 10;
          // talking check
          if (score % 100 === 0) {
            const words = ["eat", "good", "seed!"];
            speech = words[Math.floor(Math.random()*words.length)];
            speechTimer = 45; // 1.5 seconds at 30fps
          }
        }
      });

      stars.forEach((st, i) => {
        if (Math.abs(kiwi.x - st.x) < 15 && Math.abs(kiwi.y - st.y) < 15) {
          stars.splice(i,1);
          score += 30;
        }
      });

      peppers.forEach((p, i) => {
        if (Math.abs(kiwi.x - p.x) < 15 && Math.abs(kiwi.y - p.y) < 15) {
          peppers.splice(i,1);
          lives--;
          peppers.splice(i,1);
        }
      });

      if (timeLeft <= 0 || lives <= 0) {
        gameRunning = false;
        clearInterval(gameInterval);
      }

      spawnItems();
      drawGame();

      if (speechTimer > 0) {
        speechTimer--;
        if (speechTimer <= 0) speech = null;
      }
    }

    function drawGame() {
      ctx.clearRect(0,0,canvas.width,canvas.height);

      // draw Kiwi (green parrot)
      ctx.fillStyle = kiwi.color;
      ctx.beginPath();
      ctx.arc(kiwi.x, kiwi.y, kiwi.size, 0, Math.PI*2);
      ctx.fill();
      ctx.fillStyle = 'yellow';
      ctx.beginPath();
      ctx.arc(kiwi.x + 10, kiwi.y - 5, 5, 0, Math.PI*2); // beak
      ctx.fill();

      // speech bubble with pointer
      if (speech) {
        ctx.fillStyle = 'white';
        ctx.strokeStyle = 'black';
        ctx.lineWidth = 2;
        ctx.beginPath();
        // bubble rectangle
        ctx.roundRect(kiwi.x - 20, kiwi.y - 50, 60, 25, 5);
        ctx.fill();
        ctx.stroke();
        // pointer triangle toward beak
        ctx.beginPath();
        ctx.moveTo(kiwi.x + 5, kiwi.y - 25);
        ctx.lineTo(kiwi.x + 10, kiwi.y - 10);
        ctx.lineTo(kiwi.x, kiwi.y - 20);
        ctx.closePath();
        ctx.fill();
        ctx.stroke();
        // text
        ctx.fillStyle = 'black';
        ctx.font = '14px Arial';
        ctx.fillText(speech, kiwi.x - 10, kiwi.y - 32);
      }

      // seeds
      ctx.fillStyle = 'brown';
      seeds.forEach(s => ctx.fillText('üå∞', s.x, s.y));

      // stars
      ctx.fillStyle = 'gold';
      stars.forEach(st => ctx.fillText('‚≠ê', st.x, st.y));

      // peppers
      ctx.fillStyle = 'red';
      peppers.forEach(p => ctx.fillText('üå∂Ô∏è', p.x, p.y));

      // HUD
      document.getElementById('status').innerText = `Score: ${score} | Lives: ${lives} | Time: ${timeLeft}`;
      if (!gameRunning && timeLeft <= 0) document.getElementById('status').innerText += "\nTime's up!";
      if (!gameRunning && lives <= 0) document.getElementById('status').innerText += "\nKiwi fainted!";
    }

    drawGame();
  </script>
</body>
</html>
